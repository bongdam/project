<?php
	DEFINE("SYSCALL",[
		"free"				=> "free",
		"ifstatus"			=> "ubus call network.device status '{ \"name\": \"%s\" }'",
		"getpasswd"			=> 'cat /etc/shadow | grep "^%s\:"',
		"setpasswd"			=> "(echo '%2\$s'; sleep 0.5; echo '%2\$s') | passwd %1\$s >/dev/null 2>&1",
		"cpuusage"			=> "mpstat 1 1 |grep Average |tail -1 | awk '{print 100-$12}'",
		"systeminfo"		=> "ubus call system info",
		"network_cur_info"	=> "wc -l /proc/net/nf_conntrack 2&>0;wc -l /proc/net/ip_conntrack 2&>0",
		"network_max_info"	=> "sysctl net.nf_conntrack_max 2&>0;sysctl net.ipv4.netfilter.ip_conntrack_max 2&>0",
		"process_info"		=> "/bin/busybox top -bn1",
		"system_log"		=> "logread",
		"kernel_log"		=> "dmesg",
		"firmware_upgrade"	=> "sleep 2; killall dropbear uhttpd; sleep 1; /sbin/sysupgrade -n /tmp/firmware.img",
		"network_restart"	=> "/etc/init.d/network restart",
		"dhcp_reload"		=> "/etc/init.d/dnsmasq reload",
		"port_status"		=> "swconfig dev switch0 get dump_link %s | sed \"/^$/d\"",
		"uci_show"			=> "uci show %s",
		"uci_change"		=> "uci changes %s ",
		"wifi_info"			=> "iwinfo %s",
		"wifi_list"			=> "iwlist %s",
		"ifconfig"			=> "ifconfig %s",
		"ubus_exec"			=> "ubus %s",
		"cat"				=> "cat %s",
		"ip_route"			=> "ip route %s",
		"wlanconfig"		=> "wlanconfig %s",
		"reboot"			=> "reboot",
		"channel_list"		=> "iwlist %s channel | sed \"1,1d\" | sed \"s/Current Frequency://\" | sed \"s/Channel //\" | sed \"s/          //\" | sed \"s/ .*$//\" | sed \"/\./d\" | sed \"/^$/d\" ",
		"ssdk_sh"			=> "ssdk_sh %s",
		"restore"			=> "restoredefault.sh %s",
		"date"				=> "date '+%Y-%m-%d %T'",
		"date_set"			=> "date -s '%s' '+%Y-%m-%d %T'",
		"ntp_restart"		=> "/etc/init.d/sysntpd restart",
		"ntp_stop"			=> "/etc/init.d/sysntpd stop >/dev/null 2>&1",
		"firewall_restart"	=> "/etc/init.d/firewall restart >/dev/null 2>&1",
		"igmpshow"			=> "/usr/sbin/igmpshow",
		"dvmgmt"			=> "dvmgmt -x '%s'",
		"snmp_restart"		=> "/etc/init.d/snmp restart",
		"netstat"			=> "netstat -nat",
		"wifi_scan"			=>	"scan %s all",
		"tftp_upgrade"		=> "tftp -l /tmp/firmware.img -r %2\$s -g %1\$s",
		"dvlog_restart"		=> "/etc/init.d/dvlog restart",
		"sta_list"			=> "/usr/sbin/sta",
		"wifi_restart"		=> "/sbin/wifi",
		"ping"				=> "ping -c 1 -4 %s -W 1; echo $?",
		"iwconfig"			=> "iwconfig %s"
	]);
	DEFINE("SYSCALL_P",[
		"free"				=> false,
		"ifstatus"			=> true,
		"getpasswd"			=> true,
		"setpasswd"			=> true,
		"cpuusage"			=> false,
		"systeminfo"		=> false,
		"network_cur_info"	=> false,
		"network_max_info"	=> false,
		"process_info"		=> false,
		"system_log"		=> false,
		"kernel_log"		=> false,
		"firmware_upgrade"	=> false,
		"network_restart"	=> false,
		"dhcp_reload"		=> false,
		"port_status"		=> true,
		"uci_show"			=> true,
		"uci_change"		=> true,
		"wifi_info"			=> true,
		"wifi_list"			=> true,
		"ifconfig"			=> true,
		"ubus_exec"			=> true,
		"cat"				=> true,
		"ip_route"			=> true,
		"wlanconfig"		=> true,
		"reboot"			=> false,
		"channel_list"		=> true,
		"ssdk_sh"			=> true,
		"restore"			=> true,
		"date"				=> false,
		"date_set"			=> true,
		"ntp_restart"		=> false,
		"ntp_stop"			=> false,
		"firewall_restart"	=> false,
		"igmpshow"			=> false,
		"dvmgmt"			=> true,
		"snmp_restart"		=> false,
		"netstat"			=> false,
		"wifi_scan"			=> true,
		"tftp_upgrade"		=> true,
		"dvlog_restart"		=> false,
		"sta_list"			=> false,
		"wifi_restart"		=> false,
		"ping"				=> true,
		"iwconfig"			=> true
	]);
?>
